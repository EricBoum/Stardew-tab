import{d as N,r as m,f as M,c as n,a,e as l,i as h,p as C,t as b,F as k,m as O,_ as S,o as z,h as _,g as v,z as x,x as A,n as B,j as U,A as D,N as E,G as R,I as P,K as H,V as Y,W,$ as X}from"./index-B5MkLr1R.js";const Z="/assets/star-BO5th7Hv.png",q={class:"stardew-select-container relative"},G={key:0,class:"stardew-dropdown absolute w-full bg-[#f7f1df] mt-1 z-10"},K=["onClick"],J=N({__name:"index",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue","change","focus","blur"],setup(V,{emit:I}){const f=V,e=I,u=m(!1),i=M(()=>{const r=f.options.find(c=>c.id===f.modelValue);return r==null?void 0:r.name}),d=()=>{u.value=!u.value,u.value?e("focus"):e("blur")},g=r=>{e("update:modelValue",r.id),e("change",r),u.value=!1};return(r,c)=>(a(),n("div",q,[l("div",{class:C(["stardew-select w-full bg-[#f7f1df] px-3 py-2",{"stardew-select-open":u.value,"stardew-placeholder":!i.value}]),onClick:d},b(i.value||r.placeholder),3),u.value?(a(),n("div",G,[(a(!0),n(k,null,O(r.options,p=>(a(),n("div",{key:p.id,class:"stardew-option px-3 py-2 hover:bg-[#C87529] hover:text-white",onClick:F=>g(p)},b(p.name),9,K))),128))])):h("",!0)]))}}),Q=S(J,[["__scopeId","data-v-b782cdc8"]]),ee={class:"popup-box px-6 py-2 w-[400px] stardew-border stardew-font relative"},te={key:0,class:"w-full h-full top-0 left-0 absolute z-[2] bg-[#C87529] flex flex-col items-center justify-center text-[#ffffff]"},le={class:"mb-2"},se={class:"mb-2"},oe={class:"mb-2"},ae={class:"mb-2"},ne={class:""},re={class:"flex"},ue=["onClick"],ie={class:"flex items-center bg-[#f7f1df] p-2 stardew-input-container"},de={class:"w-[60px] h-[60px] mr-3 flex items-center justify-center icon-preview"},ce=["src"],pe={key:1,class:"w-full h-full flex items-center justify-center bg-gray-200 rounded-full text-gray-400"},me={class:"flex-1"},fe={key:0,class:"flex space-x-2"},ve={key:1,class:"flex"},xe={class:"flex items-center text-[12px]"},be={class:"flex items-center text-[12px] ml-5"},ge={class:"flex flex-col items-center justify-center space-x-4"},ye=N({__name:"index",emits:["on-commit"],setup(V,{emit:I}){const f=[{type:"img",label:"图片图标"},{type:"text",label:"文字图标"}],e=m({parentId:"",id:"",name:"",url:"",logo:"",desc:"",type:"img",bgColor:"#C87529",textColor:"#FFCF46"}),u=m([]),i=m(!1),d=m(!1),g=M(()=>e.value.type==="img"?"请输入图标链接":"请输入图标文字"),r=async()=>{const o=await E(),t=await R();u.value=[{id:"common",name:"常用",list:t||[]},...o];const s=await chrome.tabs.query({active:!0,currentWindow:!0}),{title:y,url:w}=s[0];e.value={parentId:"common",id:"",name:y,url:w,logo:`https://t0.gstatic.cn/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${w}&size=64`,desc:"",type:"img",bgColor:"#C87529",textColor:"#FFCF46"}},c=o=>{try{const t=new URL(o);return["http:","https:"].includes(t.protocol)}catch{return!1}},p=async()=>{if(F()){d.value=!0;return}else d.value=!1;let o={...e.value};e.value.id||(o.id=Date.now()),e.value.parentId==="common"?await P(o):await H(o),i.value=!0,setTimeout(()=>{i.value=!1,window.close()},1500)},F=()=>{const o=u.value.find(s=>s.id===e.value.parentId),t=o?o==null?void 0:o.list:[];return e.value.parentId==="common"?t.length>=Y:t.length>=W},$=o=>{try{return`https://t0.gstatic.cn/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${o}&size=64`}catch{return""}},L=()=>{e.value.url&&c(e.value.url)&&(e.value.logo=$(e.value.url))},j=()=>{e.value.url&&c(e.value.url)&&L()},T=o=>{e.value.type=o.type};return z(()=>{r()}),(o,t)=>(a(),n("div",ee,[i.value?(a(),n("div",te,t[8]||(t[8]=[l("img",{class:"w-[50px] mb-[20px]",src:Z,alt:""},null,-1),_(" 添加成功 ")]))):h("",!0),l("div",le,[t[9]||(t[9]=l("label",{class:"form-label"},"名称",-1)),v(x,{modelValue:e.value.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.value.name=s),placeholder:"请输入网站名称"},null,8,["modelValue"])]),l("div",se,[t[10]||(t[10]=l("label",{class:"form-label"},"分类",-1)),v(Q,{modelValue:e.value.parentId,"onUpdate:modelValue":t[1]||(t[1]=s=>e.value.parentId=s),options:u.value,placeholder:"请选择分类"},null,8,["modelValue","options"])]),l("div",oe,[t[11]||(t[11]=l("label",{class:"form-label"},"网址",-1)),v(x,{modelValue:e.value.url,"onUpdate:modelValue":t[2]||(t[2]=s=>e.value.url=s),placeholder:"请输入网站链接",onBlur:j},null,8,["modelValue"])]),l("div",ae,[t[12]||(t[12]=l("label",{class:"form-label"},"描述",-1)),v(x,{modelValue:e.value.desc,"onUpdate:modelValue":t[3]||(t[3]=s=>e.value.desc=s),type:"textarea",rows:"2",placeholder:"请输入网站描述（可选）"},null,8,["modelValue"])]),l("div",ne,[l("div",re,[(a(),n(k,null,O(f,(s,y)=>l("label",{class:C(["mr-5 block pointer text-[16px] font-medium mb-1",[e.value.type===s.type?"text-[#ffffff]":"text-[#ffffffb0]"]]),key:y,onClick:w=>T(s)},b(s.label),11,ue)),64))]),l("div",ie,[l("div",de,[e.value.type==="img"?(a(),n(k,{key:0},[e.value.logo?(a(),n("img",{key:0,src:e.value.logo,class:"max-w-full max-h-full object-contain",alt:"logo"},null,8,ce)):(a(),n("div",pe,t[13]||(t[13]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))],64)):(a(),n("div",{key:1,class:"w-full h-full flex items-center justify-center rounded-full",style:B({backgroundColor:e.value.bgColor,color:e.value.textColor})},b(e.value.name.substring(0,3)),5))]),l("div",me,[e.value.type==="img"?(a(),n("div",fe,[l("button",{onClick:L,class:"text-sm bg-[#CF802F] hover:bg-[#DF9040] text-white px-3 py-1 stardew-small-button pointer"}," 获取图标 "),l("button",{onClick:t[4]||(t[4]=s=>e.value.logo=""),class:"text-sm bg-[#B86646] hover:bg-[#C87656] text-white px-3 py-1 stardew-small-button pointer"}," 清除 ")])):(a(),n("div",ve,[l("div",xe,[t[14]||(t[14]=_(" 背景：")),U(l("input",{type:"color","onUpdate:modelValue":t[5]||(t[5]=s=>e.value.bgColor=s)},null,512),[[D,e.value.bgColor]])]),l("div",be,[t[15]||(t[15]=_(" 文字：")),U(l("input",{type:"color","onUpdate:modelValue":t[6]||(t[6]=s=>e.value.textColor=s)},null,512),[[D,e.value.textColor]])])]))])]),e.value.type==="img"?(a(),A(x,{key:0,class:"mt-[10px]",modelValue:e.value.logo,"onUpdate:modelValue":t[7]||(t[7]=s=>e.value.logo=s),placeholder:g.value},null,8,["modelValue","placeholder"])):h("",!0)]),l("div",ge,[l("span",{class:C([[d.value?"opacity-100":"opacity-0"],"h-[20px] my-[3px] text-[#ffffff] text-[12px]"])},"当前分类下的链接数量已满，请换一个",2),l("button",{onClick:p,class:"stardew-button w-1/2"}," 保存 ")])]))}}),we=S(ye,[["__scopeId","data-v-f1a04c90"]]);X(we).mount("#app");
