import{d as D,r as f,f as N,c as n,a,e as l,i as _,p as h,t as g,F as C,m as S,_ as $,o as z,h as w,g as x,z as b,x as B,n as A,j as L,A as U,N as E,K as M,W as P,$ as R}from"./index-B3g06kMY.js";const H="/assets/star-BO5th7Hv.png",Y={class:"stardew-select-container relative"},W={key:0,class:"stardew-dropdown absolute w-full bg-[#f7f1df] mt-1 z-10"},Z=["onClick"],q=D({__name:"index",props:{modelValue:{},options:{},placeholder:{}},emits:["update:modelValue","change","focus","blur"],setup(k,{emit:V}){const v=k,e=V,u=f(!1),i=N(()=>{const r=v.options.find(c=>c.id===v.modelValue);return r==null?void 0:r.name}),d=()=>{u.value=!u.value,u.value?e("focus"):e("blur")},y=r=>{e("update:modelValue",r.id),e("change",r),u.value=!1};return(r,c)=>(a(),n("div",Y,[l("div",{class:h(["stardew-select w-full bg-[#f7f1df] px-3 py-2",{"stardew-select-open":u.value,"stardew-placeholder":!i.value}]),onClick:d},g(i.value||r.placeholder),3),u.value?(a(),n("div",W,[(a(!0),n(C,null,S(r.options,p=>(a(),n("div",{key:p.id,class:"stardew-option px-3 py-2 hover:bg-[#C87529] hover:text-white",onClick:I=>y(p)},g(p.name),9,Z))),128))])):_("",!0)]))}}),K=$(q,[["__scopeId","data-v-b782cdc8"]]),X={class:"popup-box px-6 py-2 w-[400px] stardew-border stardew-font relative"},G={key:0,class:"w-full h-full top-0 left-0 absolute z-[2] bg-[#C87529] flex flex-col items-center justify-center text-[#ffffff]"},J={class:"mb-2"},Q={class:"mb-2"},ee={class:"mb-2"},te={class:"mb-2"},le={class:""},se={class:"flex"},oe=["onClick"],ae={class:"flex items-center bg-[#f7f1df] p-2 stardew-input-container"},ne={class:"w-[60px] h-[60px] mr-3 flex items-center justify-center icon-preview"},re=["src"],ue={key:1,class:"w-full h-full flex items-center justify-center bg-gray-200 rounded-full text-gray-400"},ie={class:"flex-1"},de={key:0,class:"flex space-x-2"},ce={key:1,class:"flex"},pe={class:"flex items-center text-[12px]"},fe={class:"flex items-center text-[12px] ml-5"},ve={class:"flex flex-col items-center justify-center space-x-4"},me=D({__name:"index",emits:["on-commit"],setup(k,{emit:V}){const v=[{type:"img",label:"图片图标"},{type:"text",label:"文字图标"}],e=f({parentId:"",id:"",name:"",url:"",logo:"",desc:"",type:"img",bgColor:"#C87529",textColor:"#FFCF46"}),u=f([]),i=f(!1),d=f(!1),y=N(()=>e.value.type==="img"?"请输入图标链接":"请输入图标文字"),r=async()=>{const o=await E();u.value=o;const t=await chrome.tabs.query({active:!0,currentWindow:!0}),{title:s,url:m}=t[0];e.value={parentId:o[0].id,id:"",name:s,url:m,logo:`https://t0.gstatic.cn/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${m}&size=64`,desc:"",type:"img",bgColor:"#C87529",textColor:"#FFCF46"}},c=o=>{try{const t=new URL(o);return["http:","https:"].includes(t.protocol)}catch{return!1}},p=async()=>{if(I()){d.value=!0;return}else d.value=!1;let o={...e.value};e.value.id||(o.id=Date.now()),await M(o),i.value=!0,setTimeout(()=>{i.value=!1,window.close()},2e3)},I=()=>{const o=u.value.find(s=>s.id===e.value.parentId);return(o?o==null?void 0:o.list:[]).length>=P},j=o=>{try{return`https://t0.gstatic.cn/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${o}&size=64`}catch{return""}},F=()=>{e.value.url&&c(e.value.url)&&(e.value.logo=j(e.value.url))},O=()=>{e.value.url&&c(e.value.url)&&F()},T=o=>{e.value.type=o.type};return z(()=>{r()}),(o,t)=>(a(),n("div",X,[i.value?(a(),n("div",G,t[8]||(t[8]=[l("img",{class:"w-[50px] mb-[20px]",src:H,alt:""},null,-1),w(" 添加成功 ")]))):_("",!0),l("div",J,[t[9]||(t[9]=l("label",{class:"form-label"},"名称",-1)),x(b,{modelValue:e.value.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.value.name=s),placeholder:"请输入网站名称"},null,8,["modelValue"])]),l("div",Q,[t[10]||(t[10]=l("label",{class:"form-label"},"分类",-1)),x(K,{modelValue:e.value.parentId,"onUpdate:modelValue":t[1]||(t[1]=s=>e.value.parentId=s),options:u.value,placeholder:"请选择分类"},null,8,["modelValue","options"])]),l("div",ee,[t[11]||(t[11]=l("label",{class:"form-label"},"网址",-1)),x(b,{modelValue:e.value.url,"onUpdate:modelValue":t[2]||(t[2]=s=>e.value.url=s),placeholder:"请输入网站链接",onBlur:O},null,8,["modelValue"])]),l("div",te,[t[12]||(t[12]=l("label",{class:"form-label"},"描述",-1)),x(b,{modelValue:e.value.desc,"onUpdate:modelValue":t[3]||(t[3]=s=>e.value.desc=s),type:"textarea",rows:"2",placeholder:"请输入网站描述（可选）"},null,8,["modelValue"])]),l("div",le,[l("div",se,[(a(),n(C,null,S(v,(s,m)=>l("label",{class:h(["mr-5 block pointer text-[16px] font-medium mb-1",[e.value.type===s.type?"text-[#ffffff]":"text-[#ffffffb0]"]]),key:m,onClick:be=>T(s)},g(s.label),11,oe)),64))]),l("div",ae,[l("div",ne,[e.value.type==="img"?(a(),n(C,{key:0},[e.value.logo?(a(),n("img",{key:0,src:e.value.logo,class:"max-w-full max-h-full object-contain",alt:"logo"},null,8,re)):(a(),n("div",ue,t[13]||(t[13]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))],64)):(a(),n("div",{key:1,class:"w-full h-full flex items-center justify-center rounded-full",style:A({backgroundColor:e.value.bgColor,color:e.value.textColor})},g(e.value.name.substring(0,3)),5))]),l("div",ie,[e.value.type==="img"?(a(),n("div",de,[l("button",{onClick:F,class:"text-sm bg-[#CF802F] hover:bg-[#DF9040] text-white px-3 py-1 stardew-small-button pointer"}," 获取图标 "),l("button",{onClick:t[4]||(t[4]=s=>e.value.logo=""),class:"text-sm bg-[#B86646] hover:bg-[#C87656] text-white px-3 py-1 stardew-small-button pointer"}," 清除 ")])):(a(),n("div",ce,[l("div",pe,[t[14]||(t[14]=w(" 背景：")),L(l("input",{type:"color","onUpdate:modelValue":t[5]||(t[5]=s=>e.value.bgColor=s)},null,512),[[U,e.value.bgColor]])]),l("div",fe,[t[15]||(t[15]=w(" 文字：")),L(l("input",{type:"color","onUpdate:modelValue":t[6]||(t[6]=s=>e.value.textColor=s)},null,512),[[U,e.value.textColor]])])]))])]),e.value.type==="img"?(a(),B(b,{key:0,class:"mt-[10px]",modelValue:e.value.logo,"onUpdate:modelValue":t[7]||(t[7]=s=>e.value.logo=s),placeholder:y.value},null,8,["modelValue","placeholder"])):_("",!0)]),l("div",ve,[l("span",{class:h([[d.value?"opacity-100":"opacity-0"],"h-[20px] my-[3px] text-[#ffffff] text-[12px]"])},"当前分类下的链接数量已满，请换一个",2),l("button",{onClick:p,class:"stardew-button w-1/2"}," 保存 ")])]))}}),xe=$(me,[["__scopeId","data-v-ddbb907f"]]);R(xe).mount("#app");
