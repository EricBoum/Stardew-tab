import{d as A,u as B,k as C,r as u,o as E,c as i,b as c,g as k,e as l,x as h,t as r,p as n,m as d,D as m,q as R,f as z,F as V,C as $,h as I,n as P,y as F,E as U,R as H,J as Y,M as Z,O as q,Z as X,$ as J,_ as W,a3 as G,a4 as K}from"./index-kvdrD2tP.js";const Q="/assets/star-BO5th7Hv.png",ee={class:"popup-box px-6 py-2 w-[400px] stardew-border stardew-font relative"},te={key:0,class:"w-full h-full top-0 left-0 absolute z-[2] bg-[#C87529] flex flex-col items-center justify-center text-[#ffffff]"},le={class:"mb-2"},oe={class:"form-label"},ae={class:"mb-2"},se={class:"form-label"},ne={class:"mb-2"},re={class:"form-label"},ce={class:"mb-2"},ie={class:"form-label"},ue={class:"flex"},de=["onClick"],me={class:"flex items-center bg-[#f7f1df] p-2 stardew-input-container"},pe={class:"w-[60px] h-[60px] mr-3 flex items-center justify-center icon-preview"},fe=["src"],ve={key:1,class:"w-full h-full flex items-center justify-center bg-gray-200 rounded-full text-gray-400"},xe={class:"flex-1"},ge={key:0,class:"flex space-x-2"},ye={key:1,class:"flex"},he={class:"flex items-center text-[12px]"},be={class:"flex items-center text-[12px] ml-5"},_e={class:"flex flex-col items-center justify-center space-x-4"},we=A({__name:"index",emits:["on-commit"],setup(b,{emit:p}){const{t:a}=B(),D=C(()=>[{type:"img",label:a("form.imageIcon")},{type:"text",label:a("form.textIcon")}]),e=u({parentId:"",id:"",name:"",url:"",logo:"",desc:"",type:"img",bgColor:"#C87529",textColor:"#FFCF46"}),f=u([]),v=u(!1),x=u(!1),L=C(()=>e.value.type==="img"?a("form.placeholderIconUrl"):a("form.placeholderIconText")),M=async()=>{const s=await H(),t=await Y();f.value=[{id:"common",name:a("link.common"),list:t||[]},...s];const o=await chrome.tabs.query({active:!0,currentWindow:!0}),{title:g,url:y}=o[0];e.value={parentId:"common",id:"",name:g,url:y,logo:`https://t0.gstatic.cn/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${y}&size=64`,desc:"",type:"img",bgColor:"#C87529",textColor:"#FFCF46"}},_=s=>{try{const t=new URL(s);return["http:","https:"].includes(t.protocol)}catch{return!1}},N=async()=>{if(S()){x.value=!0;return}else x.value=!1;let s={...e.value};e.value.id||(s.id=Date.now()),e.value.parentId==="common"?await Z(s):await q(s),v.value=!0,setTimeout(()=>{v.value=!1,window.close()},1500)},S=()=>{const s=f.value.find(o=>o.id===e.value.parentId),t=s?s==null?void 0:s.list:[];return e.value.parentId==="common"?t.length>=X:t.length>=J},O=s=>{try{return`https://t0.gstatic.cn/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=${s}&size=64`}catch{return""}},w=()=>{e.value.url&&_(e.value.url)&&(e.value.logo=O(e.value.url))},T=()=>{e.value.url&&_(e.value.url)&&w()},j=s=>{e.value.type=s.type};return E(()=>{M()}),(s,t)=>(c(),i("div",ee,[v.value?(c(),i("div",te,[t[8]||(t[8]=l("img",{class:"w-[50px] mb-[20px]",src:Q,alt:""},null,-1)),h(" "+r(n(a)("message.addSuccess")),1)])):k("",!0),l("div",le,[l("label",oe,r(n(a)("form.name")),1),d(m,{modelValue:e.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.name=o),placeholder:n(a)("form.placeholderName")},null,8,["modelValue","placeholder"])]),l("div",ae,[l("label",se,r(n(a)("common.category")),1),d(R,{modelValue:e.value.parentId,"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.parentId=o),options:f.value,placeholder:n(a)("form.placeholderSelectCategory")},null,8,["modelValue","options","placeholder"])]),l("div",ne,[l("label",re,r(n(a)("form.url")),1),d(m,{modelValue:e.value.url,"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.url=o),placeholder:n(a)("form.placeholderUrl"),onBlur:T},null,8,["modelValue","placeholder"])]),l("div",ce,[l("label",ie,r(n(a)("form.description")),1),d(m,{modelValue:e.value.desc,"onUpdate:modelValue":t[3]||(t[3]=o=>e.value.desc=o),type:"textarea",rows:"2",placeholder:n(a)("form.placeholderDesc")},null,8,["modelValue","placeholder"])]),l("div",null,[l("div",ue,[(c(!0),i(V,null,$(D.value,(o,g)=>(c(),i("label",{class:I(["mr-5 block pointer text-[16px] font-medium mb-1",[e.value.type===o.type?"text-[#ffffff]":"text-[#ffffffb0]"]]),key:g,onClick:y=>j(o)},r(o.label),11,de))),128))]),l("div",me,[l("div",pe,[e.value.type==="img"?(c(),i(V,{key:0},[e.value.logo?(c(),i("img",{key:0,src:e.value.logo,class:"max-w-full max-h-full object-contain",alt:"logo"},null,8,fe)):(c(),i("div",ve,t[9]||(t[9]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))],64)):(c(),i("div",{key:1,class:"w-full h-full flex items-center justify-center rounded-full",style:P({backgroundColor:e.value.bgColor,color:e.value.textColor})},r(e.value.name.substring(0,3)),5))]),l("div",xe,[e.value.type==="img"?(c(),i("div",ge,[l("button",{onClick:w,class:"text-sm bg-[#CF802F] hover:bg-[#DF9040] text-white px-3 py-1 stardew-small-button pointer"},r(n(a)("dialog.getIcon")),1),l("button",{onClick:t[4]||(t[4]=o=>e.value.logo=""),class:"text-sm bg-[#B86646] hover:bg-[#C87656] text-white px-3 py-1 stardew-small-button pointer"},r(n(a)("common.clear")),1)])):(c(),i("div",ye,[l("div",he,[h(r(n(a)("form.background"))+"：",1),F(l("input",{type:"color","onUpdate:modelValue":t[5]||(t[5]=o=>e.value.bgColor=o)},null,512),[[U,e.value.bgColor]])]),l("div",be,[h(r(n(a)("form.text"))+"：",1),F(l("input",{type:"color","onUpdate:modelValue":t[6]||(t[6]=o=>e.value.textColor=o)},null,512),[[U,e.value.textColor]])])]))])]),e.value.type==="img"?(c(),z(m,{key:0,class:"mt-[10px]",modelValue:e.value.logo,"onUpdate:modelValue":t[7]||(t[7]=o=>e.value.logo=o),placeholder:L.value},null,8,["modelValue","placeholder"])):k("",!0)]),l("div",_e,[l("span",{class:I([[x.value?"opacity-100":"opacity-0"],"h-[20px] my-[3px] text-[#ffffff] text-[12px]"])},r(n(a)("message.categoryFull")),3),l("button",{onClick:N,class:"stardew-button w-1/2"},r(n(a)("common.save")),1)])]))}}),Ce=W(we,[["__scopeId","data-v-e39d8b37"]]),ke=async()=>{const b=await G(),p=K(Ce);p.use(b),p.mount("#app")};ke();
